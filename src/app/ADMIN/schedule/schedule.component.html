<div class="dashboard-wrapper">
  <app-adminsidenav></app-adminsidenav>
  <div class="main-content">
    <div class="patient-header-container">
      <div class="header">
        <div class="logo">
          <i class="fas fa-calendar-alt"></i> Schedule
        </div>
        <div class="search-container">
          <input type="text" class="search-bar" placeholder="Search">
          <i class="fas fa-search search-icon"></i>
        </div>
      </div>
    </div>


    <!-- CONTENTS -->


    <div class="schedule-container">
      <div class="calendar-header">
        <button (click)="prevMonth()" class="btn">&lt;</button>
        <h2 class="calendar-title">{{ currentMonth | date: 'MMMM yyyy' }}</h2>
        <button (click)="nextMonth()" class="btn">&gt;</button>
      </div>

      <table class="calendar-table">
        <thead>
          <tr>
            <th *ngFor="let day of weekDays" class="calendar-day-header">{{ day }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let week of getWeeks()">
            <td *ngFor="let day of week"
                class="calendar-cell"
                [class.selected]="isSelected(day)"
                [class.today]="isToday(day)"
                (click)="openModal(day)">
              {{ day.getDate() }}
            </td>
          </tr>
        </tbody>
      </table>

      <div class="selected-dates">
        <h3>Available Dates and Times:</h3>
        <ul>
          <li *ngFor="let entry of availability; let i = index">
            <strong>{{ entry.date | date: 'MMMM d, yyyy' }}</strong>:
            <span *ngFor="let time of entry.times; let last = last">
              {{ formatTime(time) }}<span *ngIf="!last">, </span>
            </span>
            <button (click)="updateAvailability(i)">Update</button>
            <button (click)="deleteAvailability(i)">Delete</button>
          </li>
        </ul>
      </div>

    </div>

    <!-- Modal -->
<div class="modal" *ngIf="isModalOpen">
  <div class="modal-content">
    <span class="close-btn" (click)="closeModal()">&times;</span>
    <h2 class="modal-title">Set Available Times for {{ modalDate | date: 'fullDate' }}</h2>

    <div class="time-input-container">
      <input type="time" [(ngModel)]="newTime" class="time-input" />
      <button class="btn add-time-btn" (click)="addTime()">Add Time</button>
    </div>

    <div class="time-list">
      <h3>Times:</h3>
      <ul>
        <li *ngFor="let time of modalTimes">
          {{ formatTime(time) }}
          <button class="btn remove-time-btn" (click)="removeTime(time)">Remove</button>
        </li>
      </ul>
    </div>

    <div class="modal-actions">
      <button class="btn save-btn" (click)="saveAvailability()">Save Availability</button>
    </div>
  </div>
</div>


  </div>
</div>

